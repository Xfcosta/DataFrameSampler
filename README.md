# DataFrameSampler
The program dataframe_sampler can generate a CSV file similar to the one given in input.

### Principle
Each element in a non-numerical column is converted to a numerical value using one of two methods:

1. If one or more numerical columns are associated with the non-numerical column, a 1-dimensional embedder is used to convert this multidimensional information into a single numerical value.
2. If no numerical columns are associated, the frequency of each element is used as its numerical value.
   
A histogram with \( n \) bins is computed for each column. Each bin is then associated with all the non-numerical elements whose corresponding values fall within the bin boundaries.

We can now encode each instance as a vector, with the number of dimensions equal to the number of columns, and integer values representing the corresponding bins.

A new instance is generated by taking an instance \( x \), then randomly sampling a pair of its nearest neighbors, and applying the difference between these neighbors to \( x \) to compute a new instance. The new instance is then decoded to the original space by randomly sampling values from the corresponding bins.

Example:
Consider a data frame with two columns: one containing the names of individuals and one containing their ages. We use the age column to map the names to numerical values. Let's create histograms with 10 bins, so each bin represents a decade.

When generating a sample, we start by randomly selecting an individual, for example, Bob, who is 40 years old. We then consider two neighbors, such as Kevin, who is 30 years old (bin 3), and John, who is 50 years old (bin 5). The difference between John's and Kevin's encodings is 2. We apply the same difference to Bob, identifying bin 6. We then sample from the 6th bin and select Michael (one of the many names associated with bin 6) and choose an age of 64 (one of the possible ages in bin 6). The sampler outputs the new individual: Michael, 64.


### How to use the program
```
Usage: dataframe_sampler.py [OPTIONS]

  The program dataframe_sampler can generate a CSV file similar to the one
  given in input.

Options:
  -i, --input_filename PATH       Path to input CSV file.
  -o, --output_filename PATH      Path to CSV file to generate. By default a
                                  file called "data.csv" will be generated.
  -m, --input_model_filename PATH
                                  Path to fit model.
  -d, --output_model_filename PATH
                                  Path to model to save.
  -f, --vectorizing_columns_dict_filename PATH
                                  Path to vectorizing_columns_dict serialized
                                  in YAML.
  -n, --n_samples INTEGER RANGE   Number of samples to generate. If 0 then
                                  generate the same number of samples as there
                                  are in input. Default is 100.  [x>=0]
  --n_bins INTEGER RANGE          Number of bins.  [x>=2]
  --n_neighbours INTEGER RANGE    Number of neighbours.  [x>=1]
  -c, --sampled_columns TEXT      Selected columns to generate.
  -v, --version                   Show the version and exit.
  -h, --help                      Show this message and exit.
```

Note:  An example of a vectorizing_columns_dict serialised in YAML is as follows:
```
city:
- country_id
personName:
- age
- country_id
```
which corresponds to the python dictionary:
```
vectorizing_columns_dict = {
    'personName': ['age', 'country_id'],  # Use 'age' and 'country_id' to vectorize 'personName'
    'city': ['country_id']                # Use 'country_id' to vectorize 'city'
}
```

### How to use the library

See accompanying IPython notebook [here](https://github.com/Xfcosta/DataFrameSampler/blob/main/dataframe_sampler_notebook.ipynb).


### Installation

```
pip install git+https://github.com/Xfcosta/DataFrameSampler.git
cd DataFrameSampler
pip install -r requirements.txt
```
